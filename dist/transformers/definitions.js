"use strict";

require("core-js/modules/es6.object.assign");

var Transformer = require('./Transformer');

var _require = require('./compile'),
    compile = _require.compile,
    asFlag = _require.asFlag,
    onWhen = _require.onWhen,
    on = _require.on,
    onExist = _require.onExist,
    spread = _require.spread,
    spreadObj = _require.spreadObj; // live start & end


var liveEnd = new Transformer('PREPARING', 'liveEnd', spreadObj(['roomid', parseInt, function () {
  return 'roomId';
}]));
var liveStart = new Transformer('LIVE', 'liveStart', spreadObj(['roomid', parseInt, function () {
  return 'roomId';
}])); // danmaku

var danmaku = new Transformer('DANMU_MSG', 'danmaku', on(function (m) {
  return m.info;
}, {
  timestamp: function timestamp(i) {
    return i[0][4];
  },
  content: function content(i) {
    return i[1];
  },
  sender: on(function (i) {
    return i[2];
  }, spread('uid', 'name', ['isOwner', asFlag], ['isVip', asFlag], ['isSvip', asFlag])),
  badge: onExist(function (i) {
    return i[3];
  }, spread('level', 'name', 'owner', 'roomId')),
  ul: on(function (i) {
    return i[4];
  }, {
    ranking: function ranking(u) {
      return u[3];
    },
    level: function level(u) {
      return u[0];
    }
  }),
  medal: onExist(function (i) {
    return i[5];
  }, spread('first', 'second'))
})); // gift

var userSrc = spreadObj('face', 'uid', 'guard_level', ['uname', undefined, function () {
  return 'name';
}]);
var parseTopUser = compile(Object.assign({}, userSrc, spreadObj('rank', 'score', ['isSelf', asFlag])));
var gift = new Transformer('SEND_GIFT', 'gift', on(function (m) {
  return m.data;
}, Object.assign({}, spreadObj('giftName', 'giftId', 'giftType', 'num', 'remain', 'price', 'action', 'timestamp', 'coin_type', 'total_coin', 'super_gift_num', 'effect_block'), {
  sender: userSrc,
  left: onWhen(function (m) {
    return m;
  }, function (m) {
    return m.gold > 0 && m.silver > 0;
  }, spreadObj('gold', 'silver')),
  topList: function topList(d) {
    return d.top_list.map(parseTopUser);
  }
})));
var tempoStorm = new Transformer('SPECIAL_GIFT', 'tempoStorm', on(function (m) {
  return m.data[39];
}, Object.assign({}, spreadObj('action', 'id'), {
  storm: onWhen(function (d) {
    return d;
  }, function (d) {
    return d.action === 'start';
  }, spreadObj('content', 'time', 'storm_gif', ['hadJoin', undefined, function () {
    return 'joined';
  }], 'num'))
})));
var comboEnd = new Transformer('COMBO_END', 'comboEnd', on(function (m) {
  return m.data;
}, spreadObj('price', 'gift_id', 'gift_name', 'combo_num', 'price', 'gift_id', 'start_time', 'end_time', ['uname', undefined, function () {
  return 'name';
}], // sender name
['r_uname', undefined, function () {
  return 'owner';
}] // name of room owner
))); // broadcast message

var guardMsg = new Transformer('GUARD_MSG', 'guardMsg', spreadObj('msg', ['buy_type', undefined, function () {
  return 'guardLevel';
}]));
var sysMsg = new Transformer('SYS_MSG', 'sysMsg', spreadObj('msg', 'rep', 'styleType', 'url', 'msg_text', ['real_roomid', undefined, function () {
  return 'realRoomId';
}], ['roomid', undefined, function () {
  return 'roomId';
}])); // welcome

var welcomeVip = new Transformer('WELCOME', 'welcomeVip', on(function (m) {
  return m.data;
}, Object.assign({}, spreadObj('uid', ['uname', undefined, function () {
  return 'name';
}], ['is_admin', asFlag]), {
  isVip: function isVip(d) {
    return 'vip' in d && d.vip === 1 || 'svip' in d && d.svip === 1;
  },
  isSvip: function isSvip(d) {
    return 'svip' in d && d.svip === 1;
  }
})));
var welcomeGuard = new Transformer('WELCOME_GUARD', 'welcomeGuard', on(function (m) {
  return m.data;
}, spreadObj('uid', 'guard_level', ['username', undefined, function () {
  return 'name';
}]))); // events

var wishBottle = new Transformer('WISH_BOTTLE', 'wishBottle', on(function (m) {
  return m.data;
}, Object.assign({}, spreadObj('action', 'id'), {
  wish: on(function (m) {
    return m.wish;
  }, spreadObj('content', 'status', 'type', 'type_id', 'uid', 'wish_limit', 'wish_progress', 'count_map', ['ctime', function (str) {
    return new Date(str).getTime();
  }, function () {
    return 'timestamp';
  }], ['uid', undefined, function () {
    return 'anchor';
  }]))
})));
var roomRank = new Transformer('ROOM_RANK', 'roomRank', on(function (m) {
  return m.data;
}, spreadObj('timestamp', 'color', 'h5_url', 'web_url', ['roomid', undefined, function () {
  return 'roomId';
}], ['rank_desc', undefined, function () {
  return 'rank';
}])));
var guardBuy = new Transformer('GUARD_BUY', 'guardBuy', Object.assign({}, on(function (m) {
  return m.data;
}, Object.assign({}, spreadObj('guard_level', 'num'), {
  buyer: spreadObj(['username', undefined, function () {
    return 'name';
  }], 'uid')
})), spreadObj(['roomid', parseInt, function () {
  return 'roomId';
}]))); // blocking

var blockUser = new Transformer('ROOM_BLOCK_MSG', 'blockUser', {
  roomId: function roomId(m) {
    return m.roomid;
  },
  blocked: spreadObj(['uid', parseInt], ['uname', null, function () {
    return 'name';
  }])
});
var silentOn = new Transformer('ROOM_SILENT_ON', 'silentOn', Object.assign({
  roomId: function roomId(m) {
    return m.roomid;
  }
}, on(function (m) {
  return m.data;
}, Object.assign({}, spreadObj('type', 'second'), onWhen(function (d) {
  return d;
}, function (d) {
  return d.type === 'level';
}, spreadObj('level'))))));
var silentOff = new Transformer('ROOM_SILENT_OFF', 'silentOff', spreadObj(['roomid', parseInt, function () {
  return 'roomId`';
}]));
module.exports = [liveStart, liveEnd, danmaku, gift, tempoStorm, comboEnd, guardMsg, sysMsg, welcomeVip, welcomeGuard, wishBottle, roomRank, guardBuy, blockUser, silentOn, silentOff];
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90cmFuc2Zvcm1lcnMvZGVmaW5pdGlvbnMuanMiXSwibmFtZXMiOlsiVHJhbnNmb3JtZXIiLCJyZXF1aXJlIiwiY29tcGlsZSIsImFzRmxhZyIsIm9uV2hlbiIsIm9uIiwib25FeGlzdCIsInNwcmVhZCIsInNwcmVhZE9iaiIsImxpdmVFbmQiLCJwYXJzZUludCIsImxpdmVTdGFydCIsImRhbm1ha3UiLCJtIiwiaW5mbyIsInRpbWVzdGFtcCIsImkiLCJjb250ZW50Iiwic2VuZGVyIiwiYmFkZ2UiLCJ1bCIsInJhbmtpbmciLCJ1IiwibGV2ZWwiLCJtZWRhbCIsInVzZXJTcmMiLCJ1bmRlZmluZWQiLCJwYXJzZVRvcFVzZXIiLCJnaWZ0IiwiZGF0YSIsImxlZnQiLCJnb2xkIiwic2lsdmVyIiwidG9wTGlzdCIsImQiLCJ0b3BfbGlzdCIsIm1hcCIsInRlbXBvU3Rvcm0iLCJzdG9ybSIsImFjdGlvbiIsImNvbWJvRW5kIiwiZ3VhcmRNc2ciLCJzeXNNc2ciLCJ3ZWxjb21lVmlwIiwiaXNWaXAiLCJ2aXAiLCJzdmlwIiwiaXNTdmlwIiwid2VsY29tZUd1YXJkIiwid2lzaEJvdHRsZSIsIndpc2giLCJEYXRlIiwic3RyIiwiZ2V0VGltZSIsInJvb21SYW5rIiwiZ3VhcmRCdXkiLCJidXllciIsImJsb2NrVXNlciIsInJvb21JZCIsInJvb21pZCIsImJsb2NrZWQiLCJzaWxlbnRPbiIsInR5cGUiLCJzaWxlbnRPZmYiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUEsSUFBTUEsY0FBY0MsUUFBUSxlQUFSLENBQXBCOztlQUNvRUEsUUFBUSxXQUFSLEM7SUFBNURDLE8sWUFBQUEsTztJQUFTQyxNLFlBQUFBLE07SUFBUUMsTSxZQUFBQSxNO0lBQVFDLEUsWUFBQUEsRTtJQUFJQyxPLFlBQUFBLE87SUFBU0MsTSxZQUFBQSxNO0lBQVFDLFMsWUFBQUEsUyxFQUV0RDs7O0FBQ0EsSUFBTUMsVUFBVSxJQUFJVCxXQUFKLENB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O0FBR0FzRCxPQUFPQyxPQUFQLEdBQWlCLENBQ2J0RCxTQURhLEVBRWJGLE9BRmEsRUFHYkcsT0FIYSxFQUliZ0IsSUFKYSxFQUtiUyxVQUxhLEVBTWJHLFFBTmEsRUFPYkMsUUFQYSxFQVFiQyxNQVJhLEVBU2JDLFVBVGEsRUFVYkssWUFWYSxFQVdiQyxVQVhhLEVBWWJLLFFBWmEsRUFhYkMsUUFiYSxFQWNiRSxTQWRhLEVBZWJJLFFBZmEsRUFnQmJFLFNBaEJhLENBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgVHJhbnNmb3JtZXIgPSByZXF1aXJlKCcuL1RyYW5zZm9ybWVyJyk7XHJcbmNvbnN0IHsgY29tcGlsZSwgYXNGbGFnLCBvbldoZW4sIG9uLCBvbkV4aXN0LCBzcHJlYWQsIHNwcmVhZE9iaiB9ID0gcmVxdWlyZSgnLi9jb21waWxlJyk7XHJcblxyXG4vLyBsaXZlIHN0YXJ0ICYgZW5kXHJcbmNvbnN0IGxpdmVFbmQgPSBuZXcgVHJhbnNmb3JtZXIoJ1BSRVBBUklORycsICdsaXZlRW5kJyxcclxuICAgIHNwcmVhZE9iaihbJ3Jvb21pZCcsIHBhcnNlSW50LCAoKSA9PiAncm9vbUlkJ10pKTtcclxuY29uc3QgbGl2ZVN0YXJ0ID0gbmV3IFRyYW5zZm9ybWVyKCdMSVZFJywgJ2xpdmVTdGFydCcsXHJcbiAgICBzcHJlYWRPYmooWydyb29taWQnLCBwYXJzZUludCwgKCkgPT4gJ3Jvb21JZCddKSk7XHJcblxyXG4vLyBkYW5tYWt1XHJcbmNvbnN0IGRhbm1ha3UgPSBuZXcgVHJhbnNmb3JtZXIoJ0RBTk1VX01TRycsICdkYW5tYWt1Jywgb24obSA9PiBtLmluZm8sIHtcclxuICAgIHRpbWVzdGFtcDogaSA9PiBpWzBdWzRdLFxyXG4gICAgY29udGVudDogaSA9PiBpWzFdLFxyXG4gICAgc2VuZGVyOiBvbihpID0+IGlbMl0sIHNwcmVhZCgndWlkJywgJ25hbWUnLCBbJ2lzT3duZXInLCBhc0ZsYWddLCBbJ2lzVmlwJywgYXNGbGFnXSwgWydpc1N2aXAnLCBhc0ZsYWddKSksXHJcbiAgICBiYWRnZTogb25FeGlzdChpID0+IGlbM10sIHNwcmVhZCgnbGV2ZWwnLCAnbmFtZScsICdvd25lcicsICdyb29tSWQnKSksXHJcbiAgICB1bDogb24oaSA9PiBpWzRdLCB7XHJcbiAgICAgICAgcmFua2luZzogdSA9PiB1WzNdLFxyXG4gICAgICAgIGxldmVsOiB1ID0+IHVbMF0sXHJcbiAgICB9KSxcclxuICAgIG1lZGFsOiBvbkV4aXN0KGkgPT4gaVs1XSwgc3ByZWFkKCdmaXJzdCcsICdzZWNvbmQnKSksXHJcbn0pKTtcclxuXHJcbi8vIGdpZnRcclxuY29uc3QgdXNlclNyYyA9IHNwcmVhZE9iaihcclxuICAgICdmYWNlJywgJ3VpZCcsICdndWFyZF9sZXZlbCcsXHJcbiAgICBbJ3VuYW1lJywgdW5kZWZpbmVkLCAoKSA9PiAnbmFtZSddLFxyXG4pO1xyXG5jb25zdCBwYXJzZVRvcFVzZXIgPSBjb21waWxlKHtcclxuICAgIC4uLnVzZXJTcmMsIC4uLnNwcmVhZE9iaigncmFuaycsICdzY29yZScsIFsnaXNTZWxmJywgYXNGbGFnXSksXHJcbn0pO1xyXG5jb25zdCBnaWZ0ID0gbmV3IFRyYW5zZm9ybWVyKCdTRU5EX0dJRlQnLCAnZ2lmdCcsIG9uKG0gPT4gbS5kYXRhLCB7XHJcbiAgICAuLi5zcHJlYWRPYmooXHJcbiAgICAgICAgJ2dpZnROYW1lJywgJ2dpZnRJZCcsICdnaWZ0VHlwZScsICdudW0nLCAncmVtYWluJywgJ3ByaWNlJywgJ2FjdGlvbicsICd0aW1lc3RhbXAnLFxyXG4gICAgICAgICdjb2luX3R5cGUnLCAndG90YWxfY29pbicsICdzdXBlcl9naWZ0X251bScsICdlZmZlY3RfYmxvY2snLFxyXG4gICAgKSxcclxuICAgIHNlbmRlcjogdXNlclNyYyxcclxuICAgIGxlZnQ6IG9uV2hlbihtID0+IG0sIG0gPT4gbS5nb2xkID4gMCAmJiBtLnNpbHZlciA+IDAsIHNwcmVhZE9iaignZ29sZCcsICdzaWx2ZXInKSksXHJcbiAgICB0b3BMaXN0OiBkID0+IGQudG9wX2xpc3QubWFwKHBhcnNlVG9wVXNlciksXHJcbn0pKTtcclxuY29uc3QgdGVtcG9TdG9ybSA9IG5ldyBUcmFuc2Zvcm1lcignU1BFQ0lBTF9HSUZUJywgJ3RlbXBvU3Rvcm0nLCBvbihtID0+IG0uZGF0YVszOV0sIHtcclxuICAgIC4uLnNwcmVhZE9iaignYWN0aW9uJywgJ2lkJyksXHJcbiAgICBzdG9ybTogb25XaGVuKGQgPT4gZCwgZCA9PiBkLmFjdGlvbiA9PT0gJ3N0YXJ0Jywgc3ByZWFkT2JqKFxyXG4gICAgICAgICdjb250ZW50JywgJ3RpbWUnLCAnc3Rvcm1fZ2lmJywgWydoYWRKb2luJywgdW5kZWZpbmVkLCAoKSA9PiAnam9pbmVkJ10sICdudW0nLFxyXG4gICAgKSksXHJcbn0pKTtcclxuY29uc3QgY29tYm9FbmQgPSBuZXcgVHJhbnNmb3JtZXIoJ0NPTUJPX0VORCcsICdjb21ib0VuZCcsIG9uKG0gPT4gbS5kYXRhLCBzcHJlYWRPYmooXHJcbiAgICAncHJpY2UnLCAnZ2lmdF9pZCcsICdnaWZ0X25hbWUnLCAnY29tYm9fbnVtJywgJ3ByaWNlJywgJ2dpZnRfaWQnLCAnc3RhcnRfdGltZScsICdlbmRfdGltZScsXHJcbiAgICBbJ3VuYW1lJywgdW5kZWZpbmVkLCAoKSA9PiAnbmFtZSddLCAvLyBzZW5kZXIgbmFtZVxyXG4gICAgWydyX3VuYW1lJywgdW5kZWZpbmVkLCAoKSA9PiAnb3duZXInXSwgLy8gbmFtZSBvZiByb29tIG93bmVyXHJcbikpKTtcclxuXHJcbi8vIGJyb2FkY2FzdCBtZXNzYWdlXHJcbmNvbnN0IGd1YXJkTXNnID0gbmV3IFRyYW5zZm9ybWVyKCdHVUFSRF9NU0cnLCAnZ3VhcmRNc2cnLFxyXG4gICAgc3ByZWFkT2JqKCdtc2cnLCBbJ2J1eV90eXBlJywgdW5kZWZpbmVkLCAoKSA9PiAnZ3VhcmRMZXZlbCddKSk7XHJcbmNvbnN0IHN5c01zZyA9IG5ldyBUcmFuc2Zvcm1lcignU1lTX01TRycsICdzeXNNc2cnLCBzcHJlYWRPYmooXHJcbiAgICAnbXNnJywgJ3JlcCcsICdzdHlsZVR5cGUnLCAndXJsJywgJ21zZ190ZXh0JyxcclxuICAgIFsncmVhbF9yb29taWQnLCB1bmRlZmluZWQsICgpID0+ICdyZWFsUm9vbUlkJ10sXHJcbiAgICBbJ3Jvb21pZCcsIHVuZGVmaW5lZCwgKCkgPT4gJ3Jvb21JZCddLFxyXG4pKTtcclxuXHJcbi8vIHdlbGNvbWVcclxuY29uc3Qgd2VsY29tZVZpcCA9IG5ldyBUcmFuc2Zvcm1lcignV0VMQ09NRScsICd3ZWxjb21lVmlwJywgb24obSA9PiBtLmRhdGEsIHtcclxuICAgIC4uLnNwcmVhZE9iaigndWlkJywgWyd1bmFtZScsIHVuZGVmaW5lZCwgKCkgPT4gJ25hbWUnXSwgWydpc19hZG1pbicsIGFzRmxhZ10pLFxyXG4gICAgaXNWaXA6IGQgPT4gKCd2aXAnIGluIGQgJiYgZC52aXAgPT09IDEpIHx8ICgnc3ZpcCcgaW4gZCAmJiBkLnN2aXAgPT09IDEpLFxyXG4gICAgaXNTdmlwOiBkID0+ICgnc3ZpcCcgaW4gZCAmJiBkLnN2aXAgPT09IDEpLFxyXG59KSk7XHJcbmNvbnN0IHdlbGNvbWVHdWFyZCA9IG5ldyBUcmFuc2Zvcm1lcignV0VMQ09NRV9HVUFSRCcsICd3ZWxjb21lR3VhcmQnLCBvbihtID0+IG0uZGF0YSwgc3ByZWFkT2JqKFxyXG4gICAgJ3VpZCcsICdndWFyZF9sZXZlbCcsIFsndXNlcm5hbWUnLCB1bmRlZmluZWQsICgpID0+ICduYW1lJ10sXHJcbikpKTtcclxuXHJcbi8vIGV2ZW50c1xyXG5jb25zdCB3aXNoQm90dGxlID0gbmV3IFRyYW5zZm9ybWVyKCdXSVNIX0JPVFRMRScsICd3aXNoQm90dGxlJywgb24obSA9PiBtLmRhdGEsIHtcclxuICAgIC4uLnNwcmVhZE9iaignYWN0aW9uJywgJ2lkJyksXHJcbiAgICB3aXNoOiBvbihtID0+IG0ud2lzaCwgc3ByZWFkT2JqKFxyXG4gICAgICAgICdjb250ZW50JywgJ3N0YXR1cycsICd0eXBlJywgJ3R5cGVfaWQnLCAndWlkJywgJ3dpc2hfbGltaXQnLCAnd2lzaF9wcm9ncmVzcycsICdjb3VudF9tYXAnLFxyXG4gICAgICAgIFsnY3RpbWUnLCBzdHIgPT4gbmV3IERhdGUoc3RyKS5nZXRUaW1lKCksICgpID0+ICd0aW1lc3RhbXAnXSxcclxuICAgICAgICBbJ3VpZCcsIHVuZGVmaW5lZCwgKCkgPT4gJ2FuY2hvciddLFxyXG4gICAgKSksXHJcbn0pKTtcclxuY29uc3Qgcm9vbVJhbmsgPSBuZXcgVHJhbnNmb3JtZXIoJ1JPT01fUkFOSycsICdyb29tUmFuaycsIG9uKG0gPT4gbS5kYXRhLCBzcHJlYWRPYmooXHJcbiAgICAndGltZXN0YW1wJywgJ2NvbG9yJywgJ2g1X3VybCcsICd3ZWJfdXJsJyxcclxuICAgIFsncm9vbWlkJywgdW5kZWZpbmVkLCAoKSA9PiAncm9vbUlkJ10sXHJcbiAgICBbJ3JhbmtfZGVzYycsIHVuZGVmaW5lZCwgKCkgPT4gJ3JhbmsnXSxcclxuKSkpO1xyXG5jb25zdCBndWFyZEJ1eSA9IG5ldyBUcmFuc2Zvcm1lcignR1VBUkRfQlVZJywgJ2d1YXJkQnV5Jywge1xyXG4gICAgLi4ub24obSA9PiBtLmRhdGEsIHtcclxuICAgICAgICAuLi5zcHJlYWRPYmooJ2d1YXJkX2xldmVsJywgJ251bScpLFxyXG4gICAgICAgIGJ1eWVyOiBzcHJlYWRPYmooWyd1c2VybmFtZScsIHVuZGVmaW5lZCwgKCkgPT4gJ25hbWUnXSwgJ3VpZCcpLFxyXG4gICAgfSksXHJcbiAgICAuLi5zcHJlYWRPYmooWydyb29taWQnLCBwYXJzZUludCwgKCkgPT4gJ3Jvb21JZCddKSxcclxufSk7XHJcblxyXG4vLyBibG9ja2luZ1xyXG5jb25zdCBibG9ja1VzZXIgPSBuZXcgVHJhbnNmb3JtZXIoJ1JPT01fQkxPQ0tfTVNHJywgJ2Jsb2NrVXNlcicsIHtcclxuICAgIHJvb21JZDogbSA9PiBtLnJvb21pZCxcclxuICAgIGJsb2NrZWQ6IHNwcmVhZE9iaihbJ3VpZCcsIHBhcnNlSW50XSwgWyd1bmFtZScsIG51bGwsICgpID0+ICduYW1lJ10pLFxyXG59KTtcclxuY29uc3Qgc2lsZW50T24gPSBuZXcgVHJhbnNmb3JtZXIoJ1JPT01fU0lMRU5UX09OJywgJ3NpbGVudE9uJywge1xyXG4gICAgcm9vbUlkOiBtID0+IG0ucm9vbWlkLFxyXG4gICAgLi4ub24obSA9PiBtLmRhdGEsIHtcclxuICAgICAgICAuLi5zcHJlYWRPYmooJ3R5cGUnLCAnc2Vjb25kJyksXHJcbiAgICAgICAgLi4ub25XaGVuKGQgPT4gZCwgZCA9PiBkLnR5cGUgPT09ICdsZXZlbCcsIHNwcmVhZE9iaignbGV2ZWwnKSksXHJcbiAgICB9KSxcclxufSk7XHJcbmNvbnN0IHNpbGVudE9mZiA9IG5ldyBUcmFuc2Zvcm1lcignUk9PTV9TSUxFTlRfT0ZGJywgJ3NpbGVudE9mZicsXHJcbiAgICBzcHJlYWRPYmooWydyb29taWQnLCBwYXJzZUludCwgKCkgPT4gJ3Jvb21JZGAnXSkpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBbXHJcbiAgICBsaXZlU3RhcnQsXHJcbiAgICBsaXZlRW5kLFxyXG4gICAgZGFubWFrdSxcclxuICAgIGdpZnQsXHJcbiAgICB0ZW1wb1N0b3JtLFxyXG4gICAgY29tYm9FbmQsXHJcbiAgICBndWFyZE1zZyxcclxuICAgIHN5c01zZyxcclxuICAgIHdlbGNvbWVWaXAsXHJcbiAgICB3ZWxjb21lR3VhcmQsXHJcbiAgICB3aXNoQm90dGxlLFxyXG4gICAgcm9vbVJhbmssXHJcbiAgICBndWFyZEJ1eSxcclxuICAgIGJsb2NrVXNlcixcclxuICAgIHNpbGVudE9uLFxyXG4gICAgc2lsZW50T2ZmLFxyXG5dO1xyXG4iXX0=